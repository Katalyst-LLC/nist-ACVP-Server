using System;
using System.Threading.Tasks;
using NIST.CVP.ACVTS.Libraries.Crypto.Common.Asymmetric.LMS.Native.Enums;
using NIST.CVP.ACVTS.Libraries.Crypto.Common.Asymmetric.LMS.Native.Helpers;
using NIST.CVP.ACVTS.Libraries.Crypto.Common.Asymmetric.LMS.Native.Keys;
using NIST.CVP.ACVTS.Libraries.Crypto.Common.Hash.ShaWrapper;
using NIST.CVP.ACVTS.Libraries.Crypto.LMS.Native.Keys;
using NIST.CVP.ACVTS.Libraries.Crypto.SHA.NativeFastSha;
using NIST.CVP.ACVTS.Libraries.Math;
using NIST.CVP.ACVTS.Libraries.Math.Helpers;
using NIST.CVP.ACVTS.Tests.Core.TestCategoryAttributes;
using NUnit.Framework;

namespace NIST.CVP.ACVTS.Libraries.Crypto.LMS.Tests.Native.Keys
{
    [TestFixture, FastCryptoTest]
    public class LmOtsKeyPairFactoryTests
    {
        private readonly ILmOtsKeyPairFactory _subject = new LmOtsKeyPairFactory(new NativeShaFactory());

        [Test]
        [TestCase(LmOtsMode.LMOTS_SHA256_N24_W1)]
        [TestCase(LmOtsMode.LMOTS_SHA256_N24_W2)]
        [TestCase(LmOtsMode.LMOTS_SHA256_N24_W4)]
        [TestCase(LmOtsMode.LMOTS_SHA256_N24_W8)]
        [TestCase(LmOtsMode.LMOTS_SHA256_N32_W1)]
        [TestCase(LmOtsMode.LMOTS_SHA256_N32_W2)]
        [TestCase(LmOtsMode.LMOTS_SHA256_N32_W4)]
        [TestCase(LmOtsMode.LMOTS_SHA256_N32_W8)]
        [TestCase(LmOtsMode.LMOTS_SHAKE_N24_W1)]
        [TestCase(LmOtsMode.LMOTS_SHAKE_N24_W2)]
        [TestCase(LmOtsMode.LMOTS_SHAKE_N24_W4)]
        [TestCase(LmOtsMode.LMOTS_SHAKE_N24_W8)]
        [TestCase(LmOtsMode.LMOTS_SHAKE_N32_W1)]
        [TestCase(LmOtsMode.LMOTS_SHAKE_N32_W2)]
        [TestCase(LmOtsMode.LMOTS_SHAKE_N32_W4)]
        [TestCase(LmOtsMode.LMOTS_SHAKE_N32_W8)]
        public void ShouldSucceedWithValidParameters(LmOtsMode mode)
        {
            var seed = new byte[AttributesHelper.GetLmOtsAttribute(mode).N];
            var key = _subject.GetKeyPair(mode, new byte[16], new byte[4], seed);

            Assert.IsNotNull(key.PublicKey.Key);
        }

        [Test]
        [TestCase("null", null)]
        [TestCase("one byte", new byte[] { 0, })]
        [TestCase("15 bytes, too few", new byte[] { 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, })]
        [TestCase("17 bytes, too many", new byte[] { 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, })]
        public void ShouldThrowWhenInvalidLengthByteArrayI(string label, byte[] i)
        {
            Assert.Throws<ArgumentOutOfRangeException>(() => _subject.GetKeyPair(LmOtsMode.LMOTS_SHA256_N24_W1, i, new byte[4], null));
        }

        [Test]
        [TestCase("null", null)]
        [TestCase("one byte", new byte[] { 0, })]
        [TestCase("3 bytes, too few", new byte[] { 0, 1, 2, })]
        [TestCase("5 bytes, too many", new byte[] { 0, 1, 2, 3, 4 })]
        public void ShouldThrowWhenInvalidLengthByteArrayQ(string label, byte[] q)
        {
            Assert.Throws<ArgumentOutOfRangeException>( () => _subject.GetKeyPair(LmOtsMode.LMOTS_SHA256_N24_W1, new byte[16], q, null));
        }

        [Test]
        [TestCase(LmOtsMode.LMOTS_SHA256_N32_W1, "0000000161a5d57d37f5e46bfb7520806b07a1b800000005434d41372d517cf3334167552f9d3f06da013d94a1c4d00c9019579dd4206fa8df0890472540186c5e378f31078c0712a78fffe5dea613aa12ac0eeaaaaa672dbf4bf89767ceda994d99e8f7a04d8e94bec65da1325039050d38bb531f5b1408a04ca140e143b4fc3f2e9fb4f0094bdd414bf9b0244384754bf7a4e4d7c91f0b4239a139eec06988a91326258ce63f9a6cc7771221c00127956aa5ee6e74657116a93c347a0ec6ad9269f71affa3975785ae0d8a1a26ef0dc500900413b6929c880451ffe09bcd82dd4200755eb03305fa3bde61d326b39f1c8dddc3c4b174cad239a1cd1060a5b7d84d01f73b3ff58021b5baae44383dc806cf75d777d70202400f031db51dab3c8ad0040022ee87cc5b24d236d0dec650ce698710297c7f74b10ddd6eccd5e91c8397e7b119dfcda8c8c46a4c94620de2194293819f6fb7af5c42986541c68053231619ac8f538fc890b0da1d6abc8a662cb4751ff209884399013e29f194739e50e63532c6ab76ab1b542d484d27809ca3902ae42f68a2f7efb7b78b0729193416e22af7445b7e92cadff4ae0884d43dfc97555cf7cb2056165c98596d94e15bb880f27db1c55df3b55da3e3e32601d077ec9b16e7fb70e41ec6e3071a24e39f3f1697471030e29288a75663805a0febc453562682484d4f8828917acae3c4c0b6524a210e8c96d22f5fe67cae806a6adfb7c100aea8e2650df7b34ca47a75e6499d243ebe8cca483a1c1cb917af2e73b9ae10808d66f56ef8b6c424201dfe2342b81bf6e1e4bc22ff4b32400b941868ff55b918811848887a10211e9ce931c080339f8246337424eb5c1eabb5f32ce7dc648d4812315fece68429a7153a471eb45f96b9a5fc520dd4b3fad7aa0da4f6744e5f5e54f60d41ad9f13cdde0d1548c516990c7169a90d3b689a4d52b0d4234806f226dfe6adc9b14daeee155aa2d0fa93174fcb84bb4bc15eefc905b2baf3789cdbafff63d5a5e11f910b52ef0d5a9ed340a4130080e365adefdefa395ad631c3b72670049dbf4a5361d9b3b1a0ac0db3f613725e6d398c406d9dae4603fc95f0edda7d2fde2934547499f6872f4341bc09ac17480783757e04a7dc766bee43d9cd84575782881febb10339fe99953b717cd066a5f5a99db73313aee569526614c82e5e5b9337bd400a85570ddf2d857822a4599b47bedbd21988e7894ba3336d02f368668bb9a13fa97ed84e216371b2c9a2350c553aef5372776c74a054b0d2bf92113440c8c21a0fd1e7bf4549ae7ab260708a65695ad28bcce8d0c2377405501ddbba0007024c88872b85ed2d327081992c7e3c2de610d724e10eb906880da82fd033613dd68d3801d8fd8dc5c1cab4b277f68fa701506a0c86ab9abbe4a3e893e2a3181e33fddf89d696872eede459b7f061c5815568aaa058a9485848d0b6a822a83678003b8fdbaee242c2b58cb3488fb21c0c257292442c77dce6b4de9b43229c79358d45a509c72a2b5f61fe643dcd507ffe16509e5cecae6a0ad8d826732cba37018cdef59a615fceecec35ba2771242b29392e49b1c85911550926f07af51c170006edf44c62f3b052d0d8ae1021b6e9276172be5b548bab2d752e77f4a567fb289e1c8f8bf7086964187fecc3d23a920b9b05153c5d050366041f776fb589ee73025f0a1ba6d224b2f130f3c4e9c303215c4d8588ceacae575e42bea7f5567194bb2c80ef69b69014518e5cc0043270532b3527703a08f24f8b4f5eb3ee3749f2d53834383bac79289b48a371f1d2e2b82c36f71562f1412c1548b23f4567c679319ebed637d49a46378507c7b87015045edf399504a5d0ea803e3707978ec27f84bfc6561f8bfe07ae250185f13ccd01b09a61672482cecf4c81fa7be85dc94e9934d4eac1205f339b778ea9d72548ec825a2aa43fa2834ce5d63f84ff91dd97af50f794e591338a4b32731edcf3bf696169a8265a7fab950a537dfe951731ae0382404b41f5013afce3f68f05d11f504c2c06e34b4f235f68a62d736570bbf5ce324eab994da92a49189e76998b129da1b89e309a679ec85b295b91cb58888925c9392d2904a210a25bf30b4a39028b84fe2de69082fd03b49909a79526391196592ade8dcbe46c0a5e5da6d6eafd727dc374544537c4586e057e04f91a71245bfbf0fe7d3a9f714fc0e214b0f984d1837d941ddcad3a781a504de81851c280921bbc57dd29c4fd55a44cf8e984709531324107f55d03ac9c78abf6185f9792aaa2f9c44b615f5c44c2a4fa1f5156bacc39c012b6b9f7cff0f56878e9036bea74aec92daafef8bc66ae3594d9a3202054a22271610659e253dd69eb5ffeb70e73aac6b749a714dfc96d3477f907cadbe7d1f8822cf5aaf7e8d58da11fe88be85253491fe43c82d6e87b6b2d90fe175fb0f4d9a03ed18b82973676f02a3153543a17148a6e676491731c3179c6504f807e7b66c97ac4520c115b6bf9f90e6a276ff93067d4ca4221257229f16390fe90ec19d1d4cbf2acb09c530c6ece8d9cd57a8db570c0675ae9a0107c4481f4580378445fe534ec6ce50740321a8c562fc1c978024e3149e7c0ceb794bd99056e55239644b1caeaf125627891ce05c6bad137ef0644d6dcc6bf48a0b29d77c14e73b671887a3653ce6e7b4d9a175f9d39d870feeec0910f350a6325870c6595977bd58118ca156314d5fa42fcfb83696180f4dcb0fcb192eaee9644921fac53a5d0b07ba6865e56a73458c2c485dc3c3e4c0578126fd7078168ff6910a4efa87c28c2ce6624858606be923a3d2541dc9e7049785d8bc30f2a6896b95f6d94baead7cc7a533cf3b47ff28c4ac7ea8337f5b0be214cc7f072b71928f6c7055d3fda01d4af12d66cabbb107ae84b185cf663c6cd31f65cbe48da2c2d53de0ea25d7451fbef11e853cb7b93fc6cd92c48676e2c6c368b6ace6437698ad88ebdb87527bafd53f95951cd258a7c45360c403b0fc75f791078a0953519912ede8c7d06d2a0487d7bbd6d4ec80df1f82cb0f3e0372cbf6d94ff3df1b7f7aecd4846abc97c42b6a898cc5e4dfb877fbb73846dbfce50d1eb98f4487000ad6018992f6ab8b8a92f01d6cd986a23a2ca2c64768c96591eee7515375434b85fb8357a66fb0414b3d5b0b30cba1ecd1193dbc7be194f398d2bd19aac18d1016ce23ca2e1c9249ae89aefc9fd47b15bcea1e02acbd40b5aeb16b2e4f0f436f1df620c51f0440fb567d40d6e0b33ecd75d45025667b39a9f93b212a76c12873df442dc26023e56299917fb21232440abec26178101f5c06de12572bd3b60f250b50f8b1769f6ff79a5a45059ced349f35294768979e58263ce7b6c0c0145c03a8dfa637d63b9d6ddd477c681947b6c892b188d6f73877c7938bb3c3c130a5e5e5f453db095c071762905a6388f4e81a9f4156f5129729b6df18fc7cf4d2046d532f6d5d319425a6022f8fa1d22737b22005add0576b2f8c4807cfcb97c0bc08cc023a8f88c5de0bf1201537b7495837547569e26e2f06160dd6c279cf47e1d1b1b93ca6dc7d4bcec3ce5389d18e97f66d717218ac88c2374ea476e33da1596f4795b7f72a3e4dd988ab37cd260a3c021e86badca26b435367f63dc0d16e9f44e2f478bbffb23f62c342310ec61731c37fec9adedc127a65633b9fcecfc811a0e238a5a4ef14bcfd7c7fb2cd28bb18e7a87963fb267c4cb90bf2f660c7deea2497745010c1f66bfa7a6a10da5eeb1f62f3d4b3bffd4d97771a23c442529731491df8f6e0f1c615342fbece8adb96b56de7743ccf1267cae05fa7c996e3e7ad73dd75d25ef0b563779bd57a54d08abecabd31dba60bf031a599bd1548c1932599619f631372349803154349843b24f3c0ce73a30d19fd6fc220a8852039c1ba17be59d794645b340cd689ca81426bcdc726ac8d1dc2c7d799b52afe96d330f81f8a70e4e10bbad1d7e0104e034dc7d509327d9a5cf84d335973119297948c213b389e6d694d523fc89d7244899af1aab9ad1566df02d8a342742c92b5d8312e361a1d48da44cbf53b0debd5d2c4c0bf47f7dc9a484d6e1b9e730df52e0fd3c083820787cf1dee9acdce2d5d87e9bcaeaaeb88ffbef6d203b0840e7df099d531d4c056c1ce7795c3eaf0ca5ee5bea5bbe9aae907b2785626b0b2fdea773370823cb88aa9bceacdfa6217dcd7b3544ed8c5570989023779a53d8244e97f4992b2aeb6c8f1947a1feef2371874827748666d013b19367121c48659c37dd42437d4932ba61e8fd75cf17abaaf5a4ef60ee7801224fd4b5cf62e29e5e14e645bc6e711f27698722f678d4088becbab67bccdc96083c7e9783bec034ec21efda402af44c33f2f36fcec7f2eb684d3deb90bfa42869480f102f1fe4c2774c2fc1730a745d261a7e1188d9c70c07d6c12c6eae9584825d2ae9a49a1c34779f66bc37e73049a6c4c249940221140c6dbc22178c328af12c790a8cd0f6f02c7ea4eea8929b99fd3c2c580afe818b719a4058e2811df2f26017dcaaf420dd259d8794e02ad7bcf6f35175f716f7b86c1dd63cf84047164f2574cd413e398a4536724755a625925b826b49d51bc737a4376ab4545f31af065c7de7f6cc3caf94f3d7b3e8abb7bade454187c666f777ef8c7059cfa253e7ef3dac3e5a0d06019b1f58de96a756870c37d8d33e2db4d074306e2b73adfe124ef9599ae52d36da1a06b53b6eedc01c03b925fea2be1b0be920e8ee63d0a01aac973531c44b7410c37f1e10592c46f378b135200948d238fb41a0193eff5cd23ffc949dbc44dfa02b2fa0cb8fc17ae6c168a5eb75819969c45f65d478bffe16ee713adeca51ebcefae36e4035f6c9e232ea2980961d9a9f8548a95139b1df529bd16401332e72bfc9f1986873bd7b7b0fd7c18a8f7d83c02e9c7c9a44f359ea114cd32ca85f2ec57408c5dee74a0157eb09a01eea8c3ecd38715cb3ce76b49f38c0850e9c3103d07c545e05c333dadf830c057ed8e5a4595a13ead55ae146bb9259a2e8d750931865d6de1e742e8b4585063a8a5fdc01cb7469227c288509485c28fe68a68f2d63877ecc12d4051c3049b8fa5bf11cf4469d80ca1f3423a00fe600ecad06be3921fba41a141f2bbccc4255ffb3440efefa096ff4afd2fd2139c91c2188b27e21a59cab0a9e1b9f2d51dffc443f31b477828ce6fcc6e24c60c0c4c308be71368f6749e87b65d653bee4bd5ae50f88eab89bff91c23c1feb91e0eed0c56eaace3106ad60082a67a5135287dc0c212c0c16bfd86485eb3b371bd1e9655acb2705de9997e1bdc9fa22adfbcb25d9f6abeef862d43d89c70a8d3c07684f361f984400ef33ba3780ff8f240c7d90e70a79d2d2dfa50018c4787a0aec5adc3c329eebd75a0da613126ce1381089177a3debdc614794a5971fa64c2901103683978d04a6bd321bef072b68116fdc142e5cb9488d2ab0a6c010c972fe267e7d06921b965df1d4d8e450c7d3a312e4a9346fdc2f173530b55847cdc66c157f6a6b6ffe8184dd768f9dc2a64d71d2ed5b00c89fdd1cdf2281b7c236f4f766ad4be66ac6a548e4350de31edcaff009dffdcd588c385d879b0767ce4f84b806462aa3bb8c9618870a2e2283033857305b48a4af4b0557d34a2afcdd6c64e11aa22e4609662266e145411c1d5ac5a47d5a7cc0cc88e1c11cdc0d264927190e6c5e11ec509f8a9f5846de0c0804c0391d70acdc0ae3a0cae840abb0cbcff5a97248f7b13d595d3125af008117d15d6ed9746f5388863f3404a030d46ead64eb9e70df7dc13dfb140985df6098da8dbe05ef14b6deaf2d53a4916c24a40c91ddfcb9d9782c2efc9d1e169e19869bb0f9efd20dac17f0c769feeca68e2bb2b643e4f6a5d2063913124dac018648e40cd0e41139103fd4c74ac22f318fb159e09cb54706d0e8322d7eabd95faec46e6af4d4cee71b60551e8074f7f8d4b46759fb3c3629c84792ba38dec7e12c6d38f5f6e38409968cf08b78f4fc68803a25dd0fc6edc22440295a844af235d76fb3f823c9629c601d4bb466dd6b87eb5265585e123d40d4b24229644eb2e42514747467b9b5b5bee318ebac213809a097198c499a598788b8c5ae0405389dc255b273f90a82b46ae5e3af7451965c628b3c0a3e2668ac92fa9c0b6882ff1d95f951535894f8bbb91b05be17335f3a2c4165c993e9ce6e6b1df40e3201a30cae8233115ec0863ba9391758d848561e3644961f1ac70bef2f87a8fbbe8f80ca8f287d947d7c9c66686db8394727cd80bcfa4a4aec2d2d36f4b9d3cb489adea9edc2947ddbef81a98f56b6292fc7524d4a76f10c6344159e7046e94a7ade83b2e33399420531a7753c2a69922120a21710d352c85d53760d3f551c8be5104594d1116bd5dc5351be43416d158efa2ce9a29d4ecd146b708015a0144e39326f684caa6f3c4545b6843a933c18dc69bda693711300228c2e839e17464b9466ad3ffceb23a03d282629f5073d120a0e0b6cf464b9cc8fbd3611dbcdeb2ff809819df1d298a1b02e1c875e8bfb76035b63117bde96da2fe8753b6891e313cd605bbc30b8f8bc6a2772e4042b7c7712616a10aedfdccf0f90befaeb79b1c395ce5845b644b43df2d05b7328eb3168e0918035273ea059ce79340dc0ff1c91e6e7fd4976764ab79f91db7f36becb2c687acbf03bc7b65a411ef9da81f91db24490e86c2f29992e551e399e689e02d54d3c6c919b473570b8a788b94655b461a8d92e2984ef41710ebc412d57e6de7e778ab83c544ecafd3ad147cf308f5a2708a878f8dca6c7986c386fa4c8c6e126f1f838cc59862bc61c107aa98934e8b12522127c7c9d2d4d79f257ba9961445f1d0ef23d4d315088562a7e55ed7607332b35950f039aa1272c1264b4a57476b4ecc4191c495d7b367f9a6a208174268725c805ac45c5669bf14513fbe808b33aecf35d88cac9f577ef9899b43559516e232c25b86caf762133c9a0fcd366e79dd5486f96ff439e588b7908f152f2ec7d0dccc7e01bb90f36dda0c8e047a300484c15fb1093dae26aba10061dbfb3b09d55aac15556ff29eb52537b28e368e25fb35c47baf0da632e120ede2323b9b2bff8bc47773e588c263fbf90e473b31a0851248f416c6f806191508177dd814bc062d6caf4d0de4a39581269bd05e1ccee5dbe744cf6a28b33cf73b7cbc2ca1750c60c5df830fc48f7ccbb137d40befcea8ede47b32286d1bb404cbf354ae0633ab8b09d2a3c5c0163797aa8b6457e6bfce810ea3246037f4503d61681179d7fb118bdad85229cbb1471a6af10be9c569476fc7a8f2185692be5c9eb1ccb683a079c759ea01f10fe5457bcb60f78281c4e8e1f83000fda7f452fdde07a5ae754c7629750f94f4f3e942d872186d77367b2dd14570e63123a90d2b7aa504f4243dbd08333740a9b55b2fd2a46bdf8ea99d38520dc37fa435cb009b70992f475be614bd31dd3a8e5180cf0970a68d64968c9368e07731f1651e1c35038f30cc17a59efbc478e990501425407dde4b133ae2190876f13d75bf2d52824ff561595c6c6d3170a18ce73254aff65f805e6abb42bce344e9e1050729e0565143d2d2a34eea878786a590aa9bb83bb0b1ce32a8dafd5d152d27b27ebb03a5005a1149be2b193b15d07d8f71bf76f6bb4f4e20fc5a82161d4a334363735c9e1f0b23c034432c2f7d730fa9ac03d18d9722688a76fb976dcaf124aa0b5e96a62fb3a5bdde5a1823e5fec40865ee39c86e40e3589eff8d912f0a3f3cf418ba569e8c07e6040590d051aa881b2ac06518d03f5b787b630ef48ee16842fc5941e5039533df15b6af7a62edf243872cd8de5adb6944a02aff244d87ec3d2607eb90b87392ad39ffefcf6250ce9ccaa46799f39a1f2cf9177d1bc7e24d46456a4079febeb3acb167c5b1a4d3bb636b6949ce4ddc24f5b26f0587e0d139156536eba26a0a849d662de1d41b6001b581a4d232e7f958b5631e87cd4212e6cf96f165ac7d80472f625873e89c7d4a4c8d30426c3663c4e8f67c1baaddc7090ce25c225f8e7af3b92c312657755e28ea4ab5395f2aa77cb1e7cbd8a6b63e6bf31daec73be8e2ccd8ee89d621df0cf5d547d665029881a2b9494f9a0efb6d13a673645a4e8c31e876157cf818f7ca594c336ab4972c97eed6e857939fe261c9c493b37f1ac511db9bfebe34685a29d5e80f1c70c1d7d9fe525e35be315f6445c587a59f3e423fadc7a4e93f0a60c4de11fbcb5997ca08e931794b34ce95d11a9fe215b513dfa7b0e9287d7744eff3ad67d5bcc5ca60ea7f8bbe6feb4869ab04131ad0542eda315967e31c6e6e867411c16aa80f1917f173f97c66d3a0a9ddc13fcd0ef6b8eb36e8b30564f9a5abae495872124726a5c1d6f07f7c92276cab39e3dcb41a62715008e2e08435a7a6d58a4321472a7e8196ba85c84bc1d488b58b21f6a69490e4ed67dcecb504604e5acb4a65ffc9d8e41f9d475ec9df7b57df053c55cab0223040c4db8db61522f11abb931b8b690410ab16a9694a9bee03c2194c3f9d363eef781e585d0c097fa61cca57370865c92a81458c633989dbd60b9da2dd8337a0d3154868a3da072c905f0b3a8bb245c0034e8a9672db731541d136731cf1e0fb54c1e7681f8c0a5a24782136a1390463ac4a9f23ec2e6196289e09ff64de0b84754bb05897ea529bb59468fe9104c9b92d7a6168fc63a1dc32902add55277551f575f4e237883052f644d327b62e42669227db0cc272a7ed01765de519b7aa928928d43f055d8826216eefb8aa7056f025734464e71ef5267c761566c269cf1bf0cfd7f979371ece42077a9c901dbe88e017bbcd83c3d53e3834e4e61a57115e26c0acd092e681470b4f52b133b03858635827418bb947e564ff2cb32d8039693d2f29e6354cacda5bd4ea30d2d55b01428dd6ed48899cc5a95fbc0fefc3e71053319d85e8284c083361290870bff80b39a1b29331c41a7bf72a4b16754931a611bb756dd5ee221fdf6c642c21e7bf2b13da2574bae65d8bb76007dd3221bb3371b9c71f1de27d7fcb37e0d5f66cc837d47a6dc28f22ecbe404670c139d259249e5d0cb080fdb81ba4ab28fe955615231a9ddafaaab33fac4422c419cde53a9344d333761667fa32f45d662f46a1ebd0f00dabb5ea831f6cf3e8b966d7ee954ea761be3773de96b7f153b17393d8592370eb60157c2b36acc28b404473668f5bd75671f33dd9b2055c2947a737841af7935d9e82669b4cffb6ff7bd00c616793579a920f55b9bff55fffd7fe05c395b1cbd92ae6e347c28a164327a380fe6e7ae58fde9262efa154752ad3376577a02f7d8841e9fe60194fe1a40ec203cb56efb579b87d21529be869e9d177b69729da3cae9721af3b0a0d45bb1d2d751f9114b604ddf3930aa7c20bec1efe3e36b03d907b794dc10a7536b52233fc38ce123e648cc764a72f2c1afdb93d8dc598ad23484fa669025aff14be5d2693bfb16035124e7cb06c1a4c8dea312c7eddd3f9d98a74a5e585fcddc35b17150509b16c0a5954d8e9581f64c758ba054316ee3bb4bd37f1c9ec52bcb4f91912b3344b5a45aa1adec32e2db1681a5032ca356f3aa132e3e670a033b44f019dba4dd5c6aff2bb0a5d393a006773c39f078e5c90c437634e81d0cb293724f350b7a475afe5cc4fa0f7d37085c3012597f7eafafd78982265819f8f1cce67eb092cf5625081f3ff34e8366ebf89657c3993a8f2b3bae4ae0ffc603dddca05e8e5d885829f94b22d6e45e277e68d720aa1ef5df7b5ce5b7fee4d380599f5ece03b01e98b3b87904e566e15fa398572e35c2c138c5fab0ca5ccc220c356279466c69af04c80d3eeef21ad779a6ce93f4a87ab0be6ce84f2a785b4ec14154d09a516c0b5be8d630a07f54cabbe00a84c69486b2caaa493cdb08411c2513f9f90090a050c204c1f10772d6abcf9c046b34988657460a8d5b709442b13f97047fb5e460ed17f78bff032e9005bfe0e6ef9767367a9107269100e08b403c8441c1f772e9ffb07030daacc043796aa67e17b3f40d1c8cac29b9ee75a00f85e8c0097b6f4fa7d6b10fa522ee2afe6c4649a15e225dd605f472c5025aefcaab720ddf4b550ce2a6aab3d59be975f22c74a5c4fefc8bfcbd0b5949cfd31f48633d4af2f819f8c2e8eafaf900297ef75eab5b33f767588d5b4822b985af74846cbdc0249700ea2f1663934ea0b728a23576918eada721564d2e4a60f1c6f770a79ccacf55504c0be2e0ae71d3959563b1aa8e8bfec0bc3d9d663d0c69b437c8f55cf55ec5bad45f15842c8ba5d184d5a427e980af92fce3b7950197b8e989597c0f266c083210c8872ea1661ac3ed2dc4aaf24783039b1b80a5fadac907b97da1f7e5ceb1c673a4a8d9bcd6e998662087b68e6cd4a841caefb2f667a741fe0d9f516441a99188764304277d9038e3c9d42695ede437fd3f57c95daa2282734909aa0c84c82de6e71b6ea8446ab1b4be6e244c6e242cac312cb9b03678937fd6587c3ae43b742c89be08af95952080b3be83d3f30dc5e2dddfc14fa4ef70a36ca1db6e4e298a93c9ba0124d00e09b6c613b9bc5459bdb5fc84fa590d05d161fceb2b552a2f6714afbc5ff825cdca5b6ab66134e7a025bddff748f8bbba7d729ea65aa651f2e968c19a01ffdc28203057399824991a527c6a221a6b26590bc7a6a3c9910d8c0eca7fc2c832a22f6c5bcb07d1b6c320e254fb315d4acf5855f471b3df61740860af2557389a357b4aae4706002d8d517dc3aa3499a5acfdaa2c53de54020c6ccd8b65013f3f3a98f73ec7202655f4b05fc9e8871b35f315c1f651cd659ef8344f7e377b7f4e46555e21cedf230ae10a75a35e2e3da7181d64abde24ff512e716b71f03d12d65ffb5a022c9bb4dc461a45ece7bf1f8483cf08952ba3abec5f71e13d364725ad7f7f228cbc966ebc175f956a7bf07a8698695d3d9447539fa245ada548f476b49ac7568819229cec252fd09b234dad7062763abf35cdc61cbb0be73170d4aefede209ebfd24485e06a3695584ced02d6f3e187e38215f50dab3968541ee26bdf45507688029ac87ace2cb539986e87607d21246820669fb26d6055bdbcf37b13c2c7d7134d096f8c2746b16c83e9817a8fa802e9327d30392e46f2b3f819b858ff508d169b9cccd4659797c9c6e10f82a2ac244b20cd0dea8b007fd48bdf7c589a1c91a1c2d11e58d4b5da1e63d3e4dd5a51f3d1b6a82626eb18476f9c87f98c84e3d682c6ea1eb22897dcd442230de0fe0cc5df9415367bb04b3302d9e9b02802bd9d520eed7f88e702c74908c62e72dc6487d29248e432421e7d771a0ab23cb81094617b1af97840e2e0f7c243870946c98059b1dcf086d3a84a0b52c14cb3efd0f8e648d792d0adb62c4684c017df7e4e4c7f0bd79986a5b5b4ec0c1a0fab11f6aea8685cc36a97a86ea5fa2c77401f913b89fa0e0caaf5e69cb69dcaecd30dccd16b47ca4c088c756f5824005b8a36fb17ccc12cfaca54dc762715f772c4b9d3bb63160d670e47a9421ad7132bd09b8cc3db2cea77a1065f8c524f08ff08816fb2ae2d57b0025268e0987c8129d563d87399c6522f6e1b016fd3d8e5a950e55a6d002a3ba43df0ab1df8a8f5ce9f7d48a9369b1f21a03bec090a9492cff7484d262feb3902b81328e50a48a80d25bee7fcc013955543ed831cf7b794cf05019470e125bbdce632f63600efa5a4e4a120b014f86acc4ad45f76982617ff7405caeec016c1ae1669ca76a8ae90519541ca424acedb7615c65ed57a0a3125208d6943dcb730cd318363f7c4a7667c68009fda3d31b6e34b1ac724954a09c796f0a66f22c8df4f60c769ec6f1cc474ec16824efc8c227fdc197bfbf9c7762ad75bc0cc57389cff6a5a39a8af4cbfd5c78adad07f0636240c7ea9ff4df21c22715418d625ece0893028172e9b2e81fb165804793755049f2d9608eb458a83f9bbb804f2db2b195ead5209a3")]
        [TestCase(LmOtsMode.LMOTS_SHA256_N32_W2, "0000000261a5d57d37f5e46bfb7520806b07a1b800000005434d41372d517cf3334167552f9d3f06da013d94a1c4d00c9019579dd4206fa8df0890472540186c5e378f31078c0712a78fffe5dea613aa12ac0eeaaaaa672dbf4bf89767ceda994d99e8f7a04d8e94bec65da1325039050d38bb531f5b1408a04ca140e143b4fc3f2e9fb4f0094bdd414bf9b0244384754bf7a4e4d7c91f0b4239a139eec06988a91326258ce63f9a6cc7771221c00127956aa5ee6e74657116a93c347a0ec6ad9269f71affa3975785ae0d8a1a26ef0dc500900413b6929c880451ffe09bcd82dd4200755eb03305fa3bde61d326b39f1c8dddc3c4b174cad239a1cd1060a5b7d84d01f73b3ff58021b5baae44383dc806cf75d777d70202400f031db51dab3c8ad0040022ee87cc5b24d236d0dec650ce698710297c7f74b10ddd6eccd5e91c8397e7b119dfcda8c8c46a4c94620de2194293819f6fb7af5c42986541c68053231619ac8f538fc890b0da1d6abc8a662cb4751ff209884399013e29f194739e50e63532c6ab76ab1b542d484d27809ca3902ae42f68a2f7efb7b78b0729193416e22af7445b7e92cadff4ae0884d43dfc97555cf7cb2056165c98596d94e15bb880f27db1c55df3b55da3e3e32601d077ec9b16e7fb70e41ec6e3071a24e39f3f1697471030e29288a75663805a0febc453562682484d4f8828917acae3c4c0b6524a210e8c96d22f5fe67cae806a6adfb7c100aea8e2650df7b34ca47a75e6499d243ebe8cca483a1c1cb917af2e73b9ae10808d66f56ef8b6c424201dfe2342b81bf6e1e4bc22ff4b32400b941868ff55b918811848887a10211e9ce931c080339f8246337424eb5c1eabb5f32ce7dc648d4812315fece68429a7153a471eb45f96b9a5fc520dd4b3fad7aa0da4f6744e5f5e54f60d41ad9f13cdde0d1548c516990c7169a90d3b689a4d52b0d4234806f226dfe6adc9b14daeee155aa2d0fa93174fcb84bb4bc15eefc905b2baf3789cdbafff63d5a5e11f910b52ef0d5a9ed340a4130080e365adefdefa395ad631c3b72670049dbf4a5361d9b3b1a0ac0db3f613725e6d398c406d9dae4603fc95f0edda7d2fde2934547499f6872f4341bc09ac17480783757e04a7dc766bee43d9cd84575782881febb10339fe99953b717cd066a5f5a99db73313aee569526614c82e5e5b9337bd400a85570ddf2d857822a4599b47bedbd21988e7894ba3336d02f368668bb9a13fa97ed84e216371b2c9a2350c553aef5372776c74a054b0d2bf92113440c8c21a0fd1e7bf4549ae7ab260708a65695ad28bcce8d0c2377405501ddbba0007024c88872b85ed2d327081992c7e3c2de610d724e10eb906880da82fd033613dd68d3801d8fd8dc5c1cab4b277f68fa701506a0c86ab9abbe4a3e893e2a3181e33fddf89d696872eede459b7f061c5815568aaa058a9485848d0b6a822a83678003b8fdbaee242c2b58cb3488fb21c0c257292442c77dce6b4de9b43229c79358d45a509c72a2b5f61fe643dcd507ffe16509e5cecae6a0ad8d826732cba37018cdef59a615fceecec35ba2771242b29392e49b1c85911550926f07af51c170006edf44c62f3b052d0d8ae1021b6e9276172be5b548bab2d752e77f4a567fb289e1c8f8bf7086964187fecc3d23a920b9b05153c5d050366041f776fb589ee73025f0a1ba6d224b2f130f3c4e9c303215c4d8588ceacae575e42bea7f5567194bb2c80ef69b69014518e5cc0043270532b3527703a08f24f8b4f5eb3ee3749f2d53834383bac79289b48a371f1d2e2b82c36f71562f1412c1548b23f4567c679319ebed637d49a46378507c7b87015045edf399504a5d0ea803e3707978ec27f84bfc6561f8bfe07ae250185f13ccd01b09a61672482cecf4c81fa7be85dc94e9934d4eac1205f339b778ea9d72548ec825a2aa43fa2834ce5d63f84ff91dd97af50f794e591338a4b32731edcf3bf696169a8265a7fab950a537dfe951731ae0382404b41f5013afce3f68f05d11f504c2c06e34b4f235f68a62d736570bbf5ce324eab994da92a49189e76998b129da1b89e309a679ec85b295b91cb58888925c9392d2904a210a25bf30b4a39028b84fe2de69082fd03b49909a79526391196592ade8dcbe46c0a5e5da6d6eafd727dc374544537c4586e057e04f91a71245bfbf0fe7d3a9f714fc0e214b0f984d1837d941ddcad3a781a504de81851c280921bbc57dd29c4fd55a44cf8e984709531324107f55d03ac9c78abf6185f9792aaa2f9c44b615f5c44c2a4fa1f5156bacc39c012b6b9f7cff0f56878e9036bea74aec92daafef8bc66ae3594d9a3202054a22271610659e253dd69eb5ffeb70e73aac6b749a714dfc96d3477f907cadbe7d1f8822cf5aaf7e8d58da11fe88be85253491fe43c82d6e87b6b2d90fe175fb0f4d9a03ed18b82973676f02a3153543a17148a6e676491731c3179c6504f807e7b66c97ac4520c115b6bf9f90e6a276ff93067d4ca4221257229f16390fe90ec19d1d4cbf2acb09c530c6ece8d9cd57a8db570c0675ae9a0107c4481f4580378445fe534ec6ce50740321a8c562fc1c978024e3149e7c0ceb794bd99056e55239644b1caeaf125627891ce05c6bad137ef0644d6dcc6bf48a0b29d77c14e73b671887a3653ce6e7b4d9a175f9d39d870feeec0910f350a6325870c6595977bd58118ca156314d5fa42fcfb83696180f4dcb0fcb192eaee9644921fac53a5d0b07ba6865e56a73458c2c485dc3c3e4c0578126fd7078168ff6910a4efa87c28c2ce6624858606be923a3d2541dc9e7049785d8bc30f2a6896b95f6d94baead7cc7a533cf3b47ff28c4ac7ea8337f5b0be214cc7f072b71928f6c7055d3fda01d4af12d66cabbb107ae84b185cf663c6cd31f65cbe48da2c2d53de0ea25d7451fbef11e853cb7b93fc6cd92c48676e2c6c368b6ace6437698ad88ebdb87527bafd53f95951cd258a7c45360c403b0fc75f791078a0953519912ede8c7d06d2a0487d7bbd6d4ec80df1f82cb0f3e0372cbf6d94ff3df1b7f7aecd4846abc97c42b6a898cc5e4dfb877fbb73846dbfce50d1eb98f4487000ad6018992f6ab8b8a92f01d6cd986a23a2ca2c64768c96591eee7515375434b85fb8357a66fb0414b3d5b0b30cba1ecd1193dbc7be194f398d2bd19aac18d1016ce23ca2e1c9249ae89aefc9fd47b15bcea1e02acbd40b5aeb16b2e4f0f436f1df620c51f0440fb567d40d6e0b33ecd75d45025667b39a9f93b212a76c12873df442dc26023e56299917fb21232440abec26178101f5c06de12572bd3b60f250b50f8b1769f6ff79a5a45059ced349f35294768979e58263ce7b6c0c0145c03a8dfa637d63b9d6ddd477c681947b6c892b188d6f73877c7938bb3c3c130a5e5e5f453db095c071762905a6388f4e81a9f4156f5129729b6df18fc7cf4d2046d532f6d5d319425a6022f8fa1d22737b22005add0576b2f8c4807cfcb97c0bc08cc023a8f88c5de0bf1201537b7495837547569e26e2f06160dd6c279cf47e1d1b1b93ca6dc7d4bcec3ce5389d18e97f66d717218ac88c2374ea476e33da1596f4795b7f72a3e4dd988ab37cd260a3c021e86badca26b435367f63dc0d16e9f44e2f478bbffb23f62c342310ec61731c37fec9adedc127a65633b9fcecfc811a0e238a5a4ef14bcfd7c7fb2cd28bb18e7a87963fb267c4cb90bf2f660c7deea2497745010c1f66bfa7a6a10da5eeb1f62f3d4b3bffd4d97771a23c442529731491df8f6e0f1c615342fbece8adb96b56de7743ccf1267cae05fa7c996e3e7ad73dd75d25ef0b563779bd57a54d08abecabd31dba60bf031a599bd1548c1932599619f631372349803154349843b24f3c0ce73a30d19fd6fc220a8852039c1ba17be59d794645b340cd689ca81426bcdc726ac8d1dc2c7d799b52afe96d330f81f8a70e4e10bbad1d7e0104e034dc7d509327d9a5cf84d335973119297948c213b389e6d694d523fc89d7244899af1aab9ad1566df02d8a342742c92b5d8312e361a1d48da44cbf53b0debd5d2c4c0bf47f7dc9a484d6e1b9e730df52e0fd3c083820787cf1dee9acdce2d5d87e9bcaeaaeb88ffbef6d203b0840e7df099d531d4c056c1ce7795c3eaf0ca5ee5bea5bbe9aae907b2785626b0b2fdea773370823cb88aa9bceacdfa6217dcd7b3544ed8c5570989023779a53d8244e97f4992b2aeb6c8f1947a1feef2371874827748666d013b19367121c48659c37dd42437d4932ba61e8fd75cf17abaaf5a4ef60ee7801224fd4b5cf62e29e5e14e645bc6e711f27698722f678d4088becbab67bccdc96083c7e9783bec034ec21efda402af44c33f2f36fcec7f2eb684d3deb90bfa42869480f102f1fe4c2774c2fc1730a745d261a7e1188d9c70c07d6c12c6eae9584825d2ae9a49a1c34779f66bc37e73049a6c4c249940221140c6dbc22178c328af12c790a8cd0f6f02c7ea4eea8929b99fd3c2c580afe818b719a4058e2811df2f26017dcaaf420dd259d8794e02ad7bcf6f35175f716f7b86c1dd63cf84047164f2574cd413e398a4536724755a625925b826b49d51bc737a4376ab4545f31af065c7de7f6cc3caf94f3d7b3e8abb7bade454187c666f777ef8c7059cfa253e7ef3dac3e5a0d06019b1f58de96a756870c37d8d33e2db4d074306e2b73adfe124ef9599ae52d36da1a06b53b6eedc01c03b925fea2be1b0be920e8ee63d0a01aac973531c44b7410c37f1e10592c46f378b135200948d238fb41a0193eff5cd23ffc949dbc44dfa02b2fa0cb8fc17ae6c168a5eb75819969c45f65d478bffe16ee713adeca51ebcefae36e4035f6c9e232ea2980961d9a9f8548a95139b1df529bd16401332e72bfc9f1986873bd7b7b0fd7c18a8f7d83c02e9c7c9a44f359ea114cd32ca85f2ec57408c5dee74a0157eb09a01eea8c3ecd38715cb3ce76b49f38c0850e9c3103d07c545e05c333dadf830c057ed8e5a4595a13ead55ae146bb9259a2e8d750931865d6de1e742e8b4585063a8a5fdc01cb7469227c288509485c28fe68a68f2d63877ecc12d4051c3049b8fa5bf11cf4469d80ca1f3423a00fe600ecad06be3921fba41a141f2bbccc4255ffb3440efefa096ff4afd2fd2139c91c2188b27e21a59cab0a9e1b9f2d51dffc443f31b477828ce6fcc6e24c60c0c4c308be71368f6749e87b65d653bee4bd5ae50f88eab89bff91c23c1feb91e0eed0c56eaace3106ad60082a67a5135287dc0c212c0c16bfd86485eb3b371bd1e9655acb2705de9997e1bdc9fa22adfbcb25d9f6abeef862d43d89c70a8d3c07684f361f984400ef33ba3780ff8f240c7d90e70a79d2d2dfa50018c4787a0aec5adc3c329eebd75a0da613126ce1381089177a3debdc614794a5971fa64c2901103683978d04a6bd321bef072b68116fdc142e5cb9488d2ab0a6c010c972fe267e7d06921b965df1d4d8e450c7d3a312e4a9346fdc2f173530b55847cdc66c157f6a6b6ffe8184dd768f9dc2a64d71d2ed5b00c89fdd1cdf2281b7c236f4f766ad4be66ac6a548e4350de31edcaff009dffdcd588c385d879b0767ce4f84b806462aa3bb8c9618870a2e2283033857305b48a4af4b0557d34a2afcdd6c64e11aa22e4609662266e145411c1d5ac5a47d5a7cc0cc88e1c11cdc0d264927190e6c5e11ec509f8a9f5846de0c0804c0391d70acdc0ae3a0cae840abb0cbcff5a97248f7b13d595d3125af008117d15d6ed9746f5388863f3404a030d46ead64eb9e70df7dc13dfb140985df6098da8dbe05ef14b6deaf2d53a4916c24a40c91ddfcb9d9782c2efc9d1e169e19869bb0f9efd20dac17f0c769feeca68e2bb2b643e4f6a5d2063913124dac018648e40cd0e41139103fd4c74ac22f318fb159e09cb54706d0e8322d7eabd95faec46e6af4d4cee71b60551e8074f7f8d4b46759fb3c3629c84792ba38dec7e12c6d38f5f6e38409968cf08b78f4fc68803a25dd0fc6edc22440295a844af2")]
        [TestCase(LmOtsMode.LMOTS_SHA256_N32_W4, "0000000361a5d57d37f5e46bfb7520806b07a1b800000005434d41372d517cf3334167552f9d3f06da013d94a1c4d00c9019579dd4206fa8df0890472540186c5e378f31078c0712a78fffe5dea613aa12ac0eeaaaaa672dbf4bf89767ceda994d99e8f7a04d8e94bec65da1325039050d38bb531f5b1408a04ca140e143b4fc3f2e9fb4f0094bdd414bf9b0244384754bf7a4e4d7c91f0b4239a139eec06988a91326258ce63f9a6cc7771221c00127956aa5ee6e74657116a93c347a0ec6ad9269f71affa3975785ae0d8a1a26ef0dc500900413b6929c880451ffe09bcd82dd4200755eb03305fa3bde61d326b39f1c8dddc3c4b174cad239a1cd1060a5b7d84d01f73b3ff58021b5baae44383dc806cf75d777d70202400f031db51dab3c8ad0040022ee87cc5b24d236d0dec650ce698710297c7f74b10ddd6eccd5e91c8397e7b119dfcda8c8c46a4c94620de2194293819f6fb7af5c42986541c68053231619ac8f538fc890b0da1d6abc8a662cb4751ff209884399013e29f194739e50e63532c6ab76ab1b542d484d27809ca3902ae42f68a2f7efb7b78b0729193416e22af7445b7e92cadff4ae0884d43dfc97555cf7cb2056165c98596d94e15bb880f27db1c55df3b55da3e3e32601d077ec9b16e7fb70e41ec6e3071a24e39f3f1697471030e29288a75663805a0febc453562682484d4f8828917acae3c4c0b6524a210e8c96d22f5fe67cae806a6adfb7c100aea8e2650df7b34ca47a75e6499d243ebe8cca483a1c1cb917af2e73b9ae10808d66f56ef8b6c424201dfe2342b81bf6e1e4bc22ff4b32400b941868ff55b918811848887a10211e9ce931c080339f8246337424eb5c1eabb5f32ce7dc648d4812315fece68429a7153a471eb45f96b9a5fc520dd4b3fad7aa0da4f6744e5f5e54f60d41ad9f13cdde0d1548c516990c7169a90d3b689a4d52b0d4234806f226dfe6adc9b14daeee155aa2d0fa93174fcb84bb4bc15eefc905b2baf3789cdbafff63d5a5e11f910b52ef0d5a9ed340a4130080e365adefdefa395ad631c3b72670049dbf4a5361d9b3b1a0ac0db3f613725e6d398c406d9dae4603fc95f0edda7d2fde2934547499f6872f4341bc09ac17480783757e04a7dc766bee43d9cd84575782881febb10339fe99953b717cd066a5f5a99db73313aee569526614c82e5e5b9337bd400a85570ddf2d857822a4599b47bedbd21988e7894ba3336d02f368668bb9a13fa97ed84e216371b2c9a2350c553aef5372776c74a054b0d2bf92113440c8c21a0fd1e7bf4549ae7ab260708a65695ad28bcce8d0c2377405501ddbba0007024c88872b85ed2d327081992c7e3c2de610d724e10eb906880da82fd033613dd68d3801d8fd8dc5c1cab4b277f68fa701506a0c86ab9abbe4a3e893e2a3181e33fddf89d696872eede459b7f061c5815568aaa058a9485848d0b6a822a83678003b8fdbaee242c2b58cb3488fb21c0c257292442c77dce6b4de9b43229c79358d45a509c72a2b5f61fe643dcd507ffe16509e5cecae6a0ad8d826732cba37018cdef59a615fceecec35ba2771242b29392e49b1c85911550926f07af51c170006edf44c62f3b052d0d8ae1021b6e9276172be5b548bab2d752e77f4a567fb289e1c8f8bf7086964187fecc3d23a920b9b05153c5d050366041f776fb589ee73025f0a1ba6d224b2f130f3c4e9c303215c4d8588ceacae575e42bea7f5567194bb2c80ef69b69014518e5cc0043270532b3527703a08f24f8b4f5eb3ee3749f2d53834383bac79289b48a371f1d2e2b82c36f71562f1412c1548b23f4567c679319ebed637d49a46378507c7b87015045edf399504a5d0ea803e3707978ec27f84bfc6561f8bfe07ae250185f13ccd01b09a61672482cecf4c81fa7be85dc94e9934d4eac1205f339b778ea9d72548ec825a2aa43fa2834ce5d63f84ff91dd97af50f794e591338a4b32731edcf3bf696169a8265a7fab950a537dfe951731ae0382404b41f5013afce3f68f05d11f504c2c06e34b4f235f68a62d736570bbf5ce324eab994da92a49189e76998b129da1b89e309a679ec85b295b91cb58888925c9392d2904a210a25bf30b4a39028b84fe2de69082fd03b49909a79526391196592ade8dcbe46c0a5e5da6d6eafd727dc374544537c4586e057e04f91a71245bfbf0fe7d3a9f714fc0e214b0f984d1837d941ddcad3a781a504de81851c280921bbc57dd29c4fd55a44cf8e984709531324107f55d03ac9c78abf6185f9792aaa2f9c44b615f5c44c2a4fa1f5156bacc39c012b6b9f7cff0f56878e9036bea74aec92daafef8bc66ae3594d9a3202054a22271610659e253dd69eb5ffeb70e73aac6b749a714dfc96d3477f907cadbe7d1f8822cf5aaf7e8d58da11fe88be85253491fe43c82d6e87b6b2d90fe175fb0f4d9a03ed18b82973676f02a3153543a17148a6e676491731c3179c6504f807e7b66c97ac4520c115b6bf9f90e6a276ff93067d4ca4221257229f16390fe90ec19d1d4cbf2acb09c530c6ece8d9cd57a8db570c0675ae9a0107c4481f4580378445fe534ec6ce50740321a8c562fc1c978024e3149e7c0ceb794bd99056e55239644b1caeaf125627891ce05c6bad137ef0644d6dcc6bf48a0b29d77c14e73b671887a3653ce6e7b4d9a175f9d39d870feeec0910f350a6325870c6595977bd58118ca156314d5fa42fcfb83696180f4dcb0fcb192eaee9644921fac53a5d0b07ba6865e56a73458c2c485dc3c3e4c0578126fd7078168ff6910a4efa87c28c2ce6624858606be923a3d2541dc9e7049785d8bc30f2a6896b95f6d94baead7cc7a533cf3b47ff28c4ac7ea8337f5b0be214cc7f072b71928f6c7055d3fda01d4af12d66cabbb107ae84b185cf663c6cd31f65cbe48da2c2d53de0ea25d7451fbef11e853cb7b93fc6cd92c48676e2c6c368b6ace6437698ad88ebdb87527bafd53f95951cd258a7c45360c403b0fc75f791078a0953519912ede8c7d06d2a0487d7bbd6d4ec80df1f82cb0f3e0372c")]
        [TestCase(LmOtsMode.LMOTS_SHA256_N32_W8, "0000000461a5d57d37f5e46bfb7520806b07a1b800000005434d41372d517cf3334167552f9d3f06da013d94a1c4d00c9019579dd4206fa8df0890472540186c5e378f31078c0712a78fffe5dea613aa12ac0eeaaaaa672dbf4bf89767ceda994d99e8f7a04d8e94bec65da1325039050d38bb531f5b1408a04ca140e143b4fc3f2e9fb4f0094bdd414bf9b0244384754bf7a4e4d7c91f0b4239a139eec06988a91326258ce63f9a6cc7771221c00127956aa5ee6e74657116a93c347a0ec6ad9269f71affa3975785ae0d8a1a26ef0dc500900413b6929c880451ffe09bcd82dd4200755eb03305fa3bde61d326b39f1c8dddc3c4b174cad239a1cd1060a5b7d84d01f73b3ff58021b5baae44383dc806cf75d777d70202400f031db51dab3c8ad0040022ee87cc5b24d236d0dec650ce698710297c7f74b10ddd6eccd5e91c8397e7b119dfcda8c8c46a4c94620de2194293819f6fb7af5c42986541c68053231619ac8f538fc890b0da1d6abc8a662cb4751ff209884399013e29f194739e50e63532c6ab76ab1b542d484d27809ca3902ae42f68a2f7efb7b78b0729193416e22af7445b7e92cadff4ae0884d43dfc97555cf7cb2056165c98596d94e15bb880f27db1c55df3b55da3e3e32601d077ec9b16e7fb70e41ec6e3071a24e39f3f1697471030e29288a75663805a0febc453562682484d4f8828917acae3c4c0b6524a210e8c96d22f5fe67cae806a6adfb7c100aea8e2650df7b34ca47a75e6499d243ebe8cca483a1c1cb917af2e73b9ae10808d66f56ef8b6c424201dfe2342b81bf6e1e4bc22ff4b32400b941868ff55b918811848887a10211e9ce931c080339f8246337424eb5c1eabb5f32ce7dc648d4812315fece68429a7153a471eb45f96b9a5fc520dd4b3fad7aa0da4f6744e5f5e54f60d41ad9f13cdde0d1548c516990c7169a90d3b689a4d52b0d4234806f226dfe6adc9b14daeee155aa2d0fa93174fcb84bb4bc15eefc905b2baf3789cdbafff63d5a5e11f910b52ef0d5a9ed340a4130080e365adefdefa395ad631c3b72670049dbf4a5361d9b3b1a0ac0db3f613725e6d398c406d9dae4603fc95f0edda7d2fde2934547499f6872f4341bc09ac17480783757e04a7dc766bee43d9cd84575782881febb10339fe99953b717cd066a5f5a99db73313aee569526614c82e5e5b9337bd400a85570ddf2d857822a4599b47bedbd21988e7894ba3336d02f368668bb9a13fa97ed84e216371b2c9a2350c553aef5372776c74a054b0d2bf92113440c8c21a0fd1e7bf4549ae7ab260708a65695ad28bcce8d0c2377405501ddbba0007024c88872b85ed2d327081992c7e3c2de610d724e10eb906880da82fd033613dd68d3801d8fd8dc5c1cab4b277f68fa701506a0c86ab9abbe4a3e893e2a3181e33fddf89d696872eede459b7f061c5815568aaa058a9485848d0b6a822a83678003b8fdbaee242c2b58cb3488fb21c0c257292442c77dce6b4de9b43229c79358d45a509c72a2b5f61fe643dcd507ffe16509e5cecae6a0ad8d826732cba3701")]
        public void ShouldPrivateKeyGenKat(LmOtsMode mode, string expected)
        {
            var key = _subject.GetKeyPair(
                mode,
                new BitString("61a5d57d37f5e46bfb7520806b07a1b8").ToBytes(),
                new BitString("00000005").ToBytes(),
                new BitString("d9cc64934b53cbdb154b9a4fa0150048bc2fe82b0ec76125c198ec1bf718807b").ToBytes());

            Assert.AreEqual(new BitString(expected).ToHex(), new BitString(key.PrivateKey.Key).ToHex());
        }

        [Test]
        [TestCase(LmOtsMode.LMOTS_SHA256_N32_W1, "0000000161a5d57d37f5e46bfb7520806b07a1b800000005690f21f69dea331a49f0c694ddb1d588d64f04df54467b84adcd64f34fdecffc")]
        [TestCase(LmOtsMode.LMOTS_SHA256_N32_W2, "0000000261a5d57d37f5e46bfb7520806b07a1b8000000057deba0b6933e71adb376afc3e0fce069a778554da33bcfb83ee494a21fd1405b")]
        [TestCase(LmOtsMode.LMOTS_SHA256_N32_W4, "0000000361a5d57d37f5e46bfb7520806b07a1b8000000050c48741ae6b15be40f8c32503f06ee093e7eeddfab7a933f13b9732ebcb478d8")]
        [TestCase(LmOtsMode.LMOTS_SHA256_N32_W8, "0000000461a5d57d37f5e46bfb7520806b07a1b800000005db16a74bee9025a2fa082db03bfb63f554d819f53e82bcc9de7799ef425a0dba")]
        public void ShouldPublicKeyGenKat(LmOtsMode mode, string expected)
        {
            var key = _subject.GetKeyPair(
                mode,
                new BitString("61a5d57d37f5e46bfb7520806b07a1b8").ToBytes(),
                new BitString("00000005").ToBytes(),
                new BitString("d9cc64934b53cbdb154b9a4fa0150048bc2fe82b0ec76125c198ec1bf718807b").ToBytes());

            var expectedHex = new BitString(expected).ToHex();
            var actualHex = new BitString(key.PublicKey.Key).ToHex();

            Console.WriteLine($"expected: {expectedHex}");
            Console.WriteLine($"actual: {actualHex}");

            Assert.AreEqual(expectedHex, actualHex);
        }

        [Test]
        public void TestingAssumptionsAboutPseudoRandom()
        {
            var i = new BitString("61a5d57d37f5e46bfb7520806b07a1b8").ToBytes();
            var q = new BitString("00000005").ToBytes();
            var seed = new BitString("d9cc64934b53cbdb154b9a4fa0150048bc2fe82b0ec76125c198ec1bf718807b").ToBytes();

            var sha = new NativeShaFactory().GetShaInstance(new HashFunction(ModeValues.SHA2, DigestSizes.d256));
            var buffer = new byte[32];

            var bs = BitString.Empty()
                .ConcatenateBits(new BitString(i))
                .ConcatenateBits(new BitString(q))
                .ConcatenateBits(new BitString(new byte[2]))
                .ConcatenateBits(new BitString(new byte[] { 0xff }))
                .ConcatenateBits(new BitString(seed));

            // x_q[i] = H(I || u32str(q) || u16str(i) || u8str(0xff) || SEED).
            sha.Init();
            sha.Update(i, i.Length * BitString.BITSINBYTE);
            sha.Update(q, q.Length * BitString.BITSINBYTE);
            sha.Update(0, 16);
            sha.Update(0xff, 8);
            sha.Update(seed, seed.Length * BitString.BITSINBYTE);
            sha.Final(buffer, 256);

            var result = sha.HashMessage(bs);

            Console.WriteLine($"buffer: {new BitString(buffer).ToHex()}");
            Console.WriteLine($"result: {result.Digest.ToHex()}");

            Assert.AreEqual(new BitString(buffer).ToHex(), result.Digest.ToHex());
        }
    }
}
