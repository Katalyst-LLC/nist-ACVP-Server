//using System;
using System.Collections.Generic;
using NIST.CVP.ACVTS.Libraries.Crypto.Common.Hash.TupleHash;
using NIST.CVP.ACVTS.Libraries.Crypto.TupleHash;
using NIST.CVP.ACVTS.Libraries.Math;
using NIST.CVP.ACVTS.Libraries.Math.Domain;
using NIST.CVP.ACVTS.Tests.Core.TestCategoryAttributes;
using NUnit.Framework;

namespace NIST.CVP.ACVTS.Libraries.Generation.TupleHash.IntegrationTests
{
    [TestFixture, LongRunningIntegrationTest]
    public class MCTTests
    {
        [Test]
        [TestCase(128, "6dc13301be877363018fbbbddd779b7d8a33acb91ac0a42bb1653fdd3b43ce7e8aa259f3", "E070632D5780A4E116E6F90B0FBD5768F07BAC132E633ED33BADBB25097D0BEE312075A56A5FC55CE29DFD9F5079F3C287065F31925EE7243C0003CC29A445A4175CC94771E5E8FF8CE7B466AB94C98F27B5E00737BB0D5379399A55E1F786D8DD28DEE00981B01B1033C38EA0617F9B4C1CC551396677C39B8889155CD17CEA8D2E6CB82DCE5738740E13BA2AFF01C7C755D75A5D1BCF08560FC0369E3A59E8C6B74D3913968003ED9C78356030345C174DC5488CC63709659EFFB1F50F39E21A87CC8922E4282B74FDDBB86421D121FF92BF808D43407FE2E5441CA5BC1A31932CA093E60D307B1E8CED00FE2CC8E394BFAB20134CDB823E6B527D890DF7E6A34C9F8947642F910475BEB98D419B717E9FEC0009A5F81B07F8213F35617D8B1E7C5B7016C23DFF52D107E7A7A721D0B7F41DB69674AD12656D25B69E07361C317E525B4D3131C42403DE409D8038FC1621C05C070D88DF9EAA2E082F16B693A4A53652C65188BA46E4E2BA3C3F3FEDDBE3C087D599C27577DE031BE915C24DB34AFF270F6B4517E8D5D29087B5C24B43A0A831220E49CD4E0054A8801697AB2D541AF0F38584D7940D154EDCE4FD2BBED38FB4887070E411E21ABBBD8A978E7D20FD9AB4C30B2D0F961333A6DB66F6FFC4A1B8262D621540FBA9BCFF0CB2A74709E592E1409506D5BD66681F29119675DE0F91659F8CAC26629EB5C40658E8E9369AA862FF38CF7453C1196BFED6E83314408916DDAA4115D3FFBCCDC6BF10F08AAA76D22AFDA5DCA9749D506DD526B11CAA5C3F3FB4273E9B45AB4360629A8BC901BF98F664F05461E96E3EB7AA9DC05ACFBA85F274DB6DD90EBC23EDE126CE6F145CFF861400C4CA4A6B4DAB943D491277BB8DF651796A79933D52E8A7D63820AD8B2F2F68A595D77BA7BF18BCE9DF2A2BBE656BA02A473657A89EA594CFA3E9E42BA7D610DB86D0116BE9CAD526C28767A9CE3EEC3DBBFEB1AEAE599D899C74FCBDEA7070CB827869B9892AA50B7B4FD01C3842CD5F500986A4E0B2D90917BED25E3660B3005E5AD91D05EE1EFAD79E302CD264D779BBD241DE5579DD95F9BA9C632E5C791BB56A2DF77E00F2791AB7A2BBC4335AAD2B1D485ADA0CEB661A6D22D38EEFD7B5219A7AACEBFCC533F85C96DBF70890E23588918FF12912796C391D128D6EF8EF016FB97B78D6AAE2CBA0804D06C271C5391C51E8B0D92232C0EDDBDE82399C5E75C6FEF6CF22EF97075A118B12D1317B44DB5C7FFCDD82BCF8BD7FCF8688373FC2101167B778B91934C7A3AB83BFF7D6724A03CF04978CE2C30CB439392319ECFF5A473D414032AD72C73090DDB5FFEC635810D84F02EE5AE2BC8F730862BE093D6365A5A98227E79A89B6165DEB785FD354C137D86C4B7D145868FA591D181C9C5181399E9D851AE6166889BA27C1941A71C9B02F7FACD27C121BD4D47949EEFBB648B40CA31728D40789C7F78DF789BCDE07E81EFE77E3855DE546C04CBA68F7D8178966FFFE197FF07025989FD4A000A82FE5ACAFE7C07B780CAB9E2BAAE4C03AD1D61F178B0A5A0A83AFBA612F324742A7EE13576FB545B954AA501E4599A6B737ADE65E77AA509D93D4B2634C2401F3DF487A938D6682CA6282F2D7E3F7F40693EB2A693656819814BE8A14A7F4BFD4602E51E4F619CFE7100FE06E3C347BE59BB86A4EB90EDCDCA062979236809883C45080B9F890EEFD96FF6225A0E6DE288E348FA557B00EE506227FFB79D71D9F755A80F40EC5EF58F8CE7C7BC25EDF973A47C0BBC1FCA021060F08B99E0E791E7C90A507E0F6DC22C2A0A31B27403E564082E9AA4319AE72176AFFAF097FCFEF5427B20AC7EF928CE47BA9E03E5949A4D499B9381863378DA8D4DB18160D0146463437EBA1A1E379468C765BB4CFD0752A99FFCDAFB2CF6FD239AA2B1620FA01F73CCF4B3D395B1F91699A1724959CDDA6F17C3E0B790BEF2D003D3BEA0884CD8F583ED098056410B8B8EA37CC5629E39DCCBC47218F3B372204ABAC84EB3913D4199F641FEADF889723877D5EA84B2AAE11722B36D7C7EDF37E9F6B0EA5DCF8A13CC2777B94164A988C319DFB5E614CDE47DA04017A809A9E8E8F2C8D6FFBE8AD198A981E34E2801430DD17F9E1D1C7C1362D591E241F8BD7ADB1F662729EBBE9F83BD92ECF54C06F5B55274D7C7D79121B2D6178E2BB2CC3A2DB783E52CEA9ADCDA1CAC1FD3172DE886250FAB2702E0300AEAEC86850797D3F8DD6292A061D16BF3913AF2CB1BF8F47D450CE2F47965806503E349C6845B3FF6E6BE138D9C62229D939EF0306610F2D1296166D2CA7FDD398B06E9D1BB285CEA11B54AA1D7DBE26529EDFF83BFAEA46211DC9FB5A7FA3B7A2D20441887B9AAD830A4592D054644F19AD84E43E8137829F6894363B47708A83A8E1A746C04DD49A86AE8B6E9E77A5DAF986E3F49889038DAFCF0AB2557D652E13113E1C270CCED7A30DFF4394D2C592BD3135F34D34F6A2AF1490FF6137170646603F4E5B05D85E75E4AE4848D90877D6497E4F7C48C14BFE4B6181B61966852CA338FD39CCE0CC9EF22C0067F4E338DAD62E0D680210D68455963646AF65B4EA16100F79633AC8CA2FBDA8C7CC460C75E6E8B6C68EF4E8DFE1C9741B20E8039DEBBB4D0C53557096F3A96A4BCCBA1F96DE6D03DF3D98757288098A1D6DB994528D5B6E2D07ED5068C7B89A2960EB5F6A4101EA484A8E1FF1555B561DDA77321C2D72830D5DEE7E1325545C05FC75CD4EC11196E3662183D615DBA9E97E7F5B0F9DCFCE81C69703C8450BDA810C9A1FF729AEE248DFDC1EC535291C3A62011D0AB7FEA5AAE13BB49E614731FB58FF684B62AA88A68F9D726046798782C7C60EE8725AA833D175F6AF95651F61A52ADE0ED2124C1321A5D5FDF3A5C65C6E975E705CD739A43ED99AE630FCD74508A91A49D5C83D4063768DC65F644F86131FE2A48D6FC28B9569A9848CAEC9B2CCFEB0579C5A569985EAC7166387CF06C48D4CB243104D0207A3155C7E23EFE8A7D3205688726BFFF3F7A63C0906E83A7F58331E4CA1431DDA3E94EA22229231669B0A6C76BFB4996865705A169D822CAAA3AB774655851B0D9963073A4E6DD3910E3F53C8A8FFBB62FADE6F0DC001EE6C89AE82D32EF6B3CB177E1C2003CAA5B61462D116D20E537BA2FDDAC78E71E8EB434DD81164A2E3C857C2057C44C0380874C216C716D94326287469227520BCCD9928020C30B4EF070E497DCDFA65A364963FBA74B910D891F6D84A5539E952F3AD12B9F66BF070C2615736138E540E1083463F059035327260113D3647E38A4C0180B00EC046508BB264E77FE3DC6EA0CCB0536FA5DC4E924C89A7B1231CF5C9EAEE318F6E13EEEE1957EC1A9A4F8D9BB945A09EB1AE22E50E90D627DBA79C75E36B1A3A3F926425047F9184815770BC75375579B02A087CE1F0866900CE2129F987CB26B70D10090BB42729AB415918202AE8F640E1421BA03778ADE48A3540BB2202E8033D7DDD8F7D7B864C872CD9C7026A24C391A160E8C80A33FAB1C479B4D2485F4BDADA4DB3B5C9A96084CFBE37FD3465E3C42EA62A34A0125EA11082E6926E6C4A5D6BA4EFD31B48902914D55A417B8A915E7E6BFEB33369CDF329A96BD88B10D5714E97E9F9E081BE708B0FEC39063D5744C4118595A8B113F35AEA34D2E92869E3C3068FBBB17A2DED19F5287A21E3A1FCBA65BDBAA072B2EC9C033D649CF71DBA225F0B98B8BC35AF803B790BE45A0C238EED06E5B620909C8293956F45CF5D686500D6E45AED88B446973AF2C8280BAE85FB3963DDC5E5FBAAC0707C6FBA1DFD76111AF020E42009E6849EF076A096A73F6199077A689245B4C3FABBE1B0264C500AEA4AFCA6A0CF3EC893F647606CF8453F554342A47278347E61D98F6B4DD20F3254F7EF2F4FA07AFC9ED2B48426ADF6CB96B3DCF03E86AB997556089AB4A467ED6346B50F7A34D907218FD3074E49B086765FBA270774C6A73C895C2F1F60686BEF1BAADB4631ABF565E9B667E1D80BA23E33CA969CB98BCDB88794A0EFD76A261AE8128718121C7DE542687809206DE331390747CC51B140EA463AC2682AB34466984D5928B92F830B8BFE6281FF2F847C223DCC85EB81A508B611F1F2E42AA3725566DABA030398A8B53A1FD22BC7E90F2125721C48707F498EC133D49D8B3F023B961E831F7C67E5CBD5163F34FD7455608027A91B69C249A6271200590BF5FD26F5CC685FB6D29951437F4AB0F86D61AF04D27BB3A6CA4EF302C6AD80832897328A508988388D30F5E57C2D3010017603839ED6BDE6A1D08924CB20AA0734473A01E88BE4F41A6585775317709BE400AF082BDDFEAF66CBB8D40BFB3FEE7FAA7E435C980461D906491D009428ABDFD0C7D69ECA2AF648764E3339EAE1AB1E428A9A70F57B0516AEF3B4612E62D6DF0A4D9E5BC6F74FAB609A947730058A07F1417F2A51156C2DAB9B2421B48389681A343F2F102651CB73887260BB5194741B096BDAFDF14423FF06944657BB6725FC1C505D65C2304FC5F4D4D1B219A8D9F83B91F6C10AB5C33C83E7B2D7B5555B2F3E24150E8C3EDFCE15C3AA4F0F33886C6D666C2D864886E194A3433F94F98596D77CB2EC67599278648B7B6E0A59AC5D1BAD7E5390AFCB4FD5098956C30B50452940518C449134222AE13E3FD5717AC94215DED9F33C2A3D548185E6F43B2C9EF1A7009AE865CF7C8E19EDF1E5456E0CCFD71AAD9EDC8590CF733B783398BBC3C4891B65ED498A062B3584B8EBEBF4F11348167B5C122CD645F0D08464B21F0AC0217DF12E4B486F24937BCBFB363B94001878FC08084252A00B902365603D920A62C0EAD3E13949B9DAE0A526E7E3F31693440A9EDBA918AE4A9ED4571EBF77E590CDB5F8072CCC294138A85D3E7B56C61E529EECC40D43CDECC09AC525A6F40ABA1439C125FC47D7EB40BE5AF6BC9C6427DB463CD724D4616F70697AA22C23DCC547A9D2BDFEE92C70BBBE9F011483D46208A37FCE9257BA617021FE6C4253C6F99E75A949A6965029C93756D18CC72C65241319173D1AB77F9D7D3C53A283DDBBF0B46101011C1BF9A6ED7E46ED4B627F203CFFB16A0B76207B4CC0E69406B715651FE8215AAB510463C1176AD5FB826BAAC157A3ECDFD3A780CFC4FC1E4D0E70CFFF06A13A6B90CEA4352DBA481321240173657242726315C6E98F1D11B3C1B79751FF5202A423F2B466494C70CFA6D2E5BA41DD5621EB9CA659863C24074B662FA3142B04F06C2D8763C18AFCBE819CD7EC32FF9199318DEFEFC68511BF9E97D518B0FC096CD276323B5D145ABECE5F57D7B823DF4EC409D25499452C3A5241B739D25E5FC8E2AF488EE7F253ACC183BF28414DDD32F87AD75F8382DD031E5B5232545882D7CC89A4849D5C9495E5581637AA72C7AAB31D53646ED2D5B47D5F713FD55EAABCAA2DAD23E99BD8E10585BFEEB8892065D3004438A162824589DC46C7BA1E599C614BD6C8ECDC8C3A5AFDA64C306BC64D3E4D5D5FFF8CDB03BA4A9E2FB86CA6952A7C96766C18BF8D8312637EC6DCBDB9F337DD3BDA99F7B3337B2733BEEFE76351CF08508891337070890E7BCAFB92E26533108D6380FF2EAAE8E02D6D8BCBE780C653F65ED09D28A2E7C123570FAF3D83AF5C74218DC617AEA129163CE4473E8430517D6B5A01A98CC4959BFEB12EA75BF8211B122A9EF356E3C232327343AA643D18830D138A5914162A76DCACE85BD6954A3CD85C934912E53AC3708AA401D5F9FCF5DE1540ABF9D06EF2F3797B93A729B09400499B642A901F92A7F19CAB32D3D37F37A944E28A2FFCD56CA20E1C15A2338560CAE2BD1360A59081ED28D3556D6EA8F06E30D3751E73CDAEE6FBBD88044CC571F13776194340869CE8F1BCF03336FD56CA5E148F059BBB61588510F6A930EA8564592A3E3DFDB9AB1B79B3A3C114C18C6CFEB7028872D36A934672CAEAA9779942D3F1F8C014AF2F1DA4ACAC9275AF07A8BBDC9E9D9E21CE82C885905FBCE7F80A8962AD32085AD418338BB2D472F0049F95D19BFF20663D4A1431FE883E4EF4D472BC211E9D27CEB46EEB36222E3D790CF055CC3DAC184C999DD808C9D2960AB4918333750C83285F3976E371F22BB66319737A3FC1302765465093249C77523CDCCB1A6D5BA49FABDE8CB1BB51D97E79006838B22A1B1341111B385B9C2F715BF9814A84A201D10BF21413EB9147C1F487971EBB318BA01F2A50270B4831E93D95B3ABBAAFEAE38350507735CA9D8C4F22ED864BF43AFB882C6476E83D318FF4337D7B1880DCAAFC27D5857E01BA7F4BB8427FF1AF68E65D4789689A4385B3068E48FA4D2543C2139D44971963061B562AC4BB2D6A3FE673F52FDA9F6B6C2322C18CCE2DB4CA788A74A9B879D34719E674ED78E10F55430398FF32980C7BF38BDEC05C30DAF3EABF51DF3B736643C4F9C5F3365617E79F441261BD3CD1CF6C052715087A24B5E780FCB8399A63103BE641355F33695EC84A543682D05C0ABE8DC73B8A7B5A9380852D0F8E91DFA2005F08B701913D46A7CB1EC635DE256524A22B3C2EBBD1CF3CA7FD14F4C7D40FD9112609644751905146655CC4DB895A215389734836FF4F0F7E2D13D0269ED6F5DE5A43DB144399C645C3139D26670E09E3C50C15D19BFA6F0F3CB67132AC000B2E61C0A1B1EA6EED2849F9CD8255020CD75BEBA205223C87305FBD8A25B106F725DF5455B6DA0061B76C26A079E5475E3710A76DD92E988323BC496D9025E8591CFB8BD300FC2F7627BDCC3719AA9FE165521E3EED860BC9C56689FDD0F1BACAB6EDAB6E92C4AED9ED087B364360BFDBF26C3DDC75A0B0FF9398CCB62F07E8B45253CDC7197319B5FFA1FF8D6FBC8D754817252D5AA9E30D995C75B8FF14A1F3A13571FDC5637DEEA60347ACA6A09D55E270E3F7D135C530876D5129C9C7E8C5E20FD7927CC6B5EA14DF9D95FF2F5A4BCCCDC174B56213C8C216471A668881531D5E557B499FA528D4ED227230923A5C2104452A71233D2EC6A31977D64F9BA9AF642ECBCEDC6887ACDBF9F70D79A0EE4B7C540A1855331F2BE04104D5B08504AA09672DB5A2C0EE45A55747B26C570F0E0CE934A3DC56B51C6BEC5EAA394C4E7420EDBE94CA51F692A8A65FBED4BBE7BF31ED228E8A07890448A99BD80C8A8C4BF8B573F12701AC224E16005038C7B9A5F3094277EAFA01692723669195F7AC1B406B5BF13BC6196FBDE475E3EC7E860F08432F0289BDFFFADADD6E47B1FA274F2BF032AA01E15D94D69028C1FC06BB99AF7BEB7F73FDAA7A6398BE2507673DA528E5EE4F98E9B277E2D18141F68A4C16FC89B0B2685A727EED29D02A52BD399FBD849871BA330682E4F4F7657D9A64B7FA44214A5FC967DDB23098A69AB344A91A0F89CC7E45B6D202D894C04414ABD7874C079CB6FF00ACD80747C297C68ECA2F869D0801ABF6C8A9B8E631B63710F755AD483A182F492A90CB06795C0D3B1CDA0E628D7F66F270E9EE6877921292361169060D1F7A1367970D201700036A4B6DF5A45DF14CEF53B7A2A74CB4042B8EB03893F6C193EED639CE65A946A6975469D042DA495A1F0FFDC7C3CC31B237E1210DEF707B694AAAFA5B5017886566626DE6F8375FBCAF93AC06C1FD4FE2F87A827CC870E16052CBC75843E73F069BCBA726CC17291EB698EA384B501986D4AF3547BAA2944E903CDA2C9C8C3A5F16CF1F661174E69E9C62D89178A2C1D75145FED919E0383F85532E8F50F84DAD30B94DFFD0574C90B45819F2F1C6A432AAB793051F6AF46DAA218EDB0EE55FA0AD0D8D708C2F446DD7762514F0492603871233109C27F7BA3570886047CDDDBECAA9765FFE9A82860B492CAD85CA0570A94B0F32DCD696259C83C057A3615ADB9B92BB5960749DCBE10D2AD905ABF28E14BC9D0D4800E450E45BDDED6C750112DEC57E973A3A9321A2DFA64BD5A63ECD252DBF9828", TestName = "TupleHash 128 MCT")]
        [TestCase(256, "acb91ac0a42bb1653fdd3b43ce7e8aa259f36dc13301be877363018fbbbddd779b7d8a33", "B2DE21FFDF128E68B72F4D9A6672CB005DE42889F5A4DA7B1CD699EF60064BB193F56A906AD053682D3C77566AA5598D930DCCB61B4C05CCAAF874F11EA89A430D8BC701B8131AF9723599E5DA9287742864088C3DEB1A777B289A59ADBD37C02F1429CA5B8D2F9C0A90E3088BAE9264EA6FFDACBFE3DED1E973C974DC3FAE1F26FED1411FD80C38499299BEBE229AD319E80D1D579C9C08F55472574DCC9D10AAB395B395FC08EF164A8F148DB6B2608B64B9A88DE9F417F30D585E41D6C33C86EA55F31D6792CD5063B43680E7C8926C9ABC48E226176545B3930E2CEF576DE9BAF9F52AACF47AFA4721E674B76B2AC579DDA6DB009D928EE0E3F5106F7D9673D1753919648921FF4D8E47F3E81AAABEC81836A7C736FA8B3CC2D302F7199F009851381B91F283883B906A9A03B57B64E57C453E7EEF7DDE0992AA8EEC46B657BFEAD7F859F2D8E6BD868B2A75812E069CEE5F99133B041749A1342D35E869E2B1220869D579B34ACD5B25ADBA8CE8C45FE44550159EDD112511CF1A433FD70EA46F0A56ACF05BF040168EB04D54A4AC0BE965D94E2A41424869A86CDA91E540687CB5CB58A069EEDE30B55108DD4E5C423E384A35492DBF10CE60C22A52EB435626494448186B60193BA497746A65242F2B0D818F06EACAC51D683284E8A090DEAC2E200CF57B275E680D07C967BB44377597D0A561C5AA947198A42713E99FF333BEB39364E4DBFF8FEE7FA1259D3423EF72006095E291BB96875ADB00636064E042277F307BA0BF6A95D6253105BBE616F5DC5EDDAAE45ABB9F8824A45A59308B7FE6212D9FEF90B555B69DFA9BA2DB3FB2231FC48E750C48057AB377CAB67033F4CFEF634F216764E10570E1C667CA380251829DAD834C03CE9FC62F3944013928BEAB388D84E08E098066F01C91FE5B1AB9A94DB42C0BDCCC1C7E86313FD8D4B8BB1049B79B09A833A36581AB6E11B573AB06B8759E1A1146AFCA04C803AE4CA7A771D07648464BB31571039F0B55FB9A31FF4BB868EF4BA7775A0E099AE43320B8792FBE5F74A81F4710613304E016960BFDD976493935C0E8B49956AD2C9CC0623FB5A31AE9C93ADA5D4740F96F3E8E8B9039F11DC8306264231FFF8C040F1E7692BD2FEC0609A7380931E2E85B6AC6713BF31C552BCDB8F97462EE805A588F7AE197CF2F3B036ADB03E8CBA2C5FCBE70B051540099AC6AD2884033044EF27687D5649995FB4FCACB71AC00D1A4DCB5557BD474C05AED985297066FD769497E94561C9846A44D924073D13431E4F57EA162D8B66FECEB881E968363F5100116716F92B24B0484D63FB1EEDC4C302C3D3EF752C0A69B5BA09E459E28EAFE59E6238762FABE5F6F46654B92AEB15E21D6C4C16B275FD8A052FE5488795D90A586FBC6D1F09F6753C13C7BE9D039780688F71494B626DACE782DC8009C831271F22B1043CE4B4BAB0ECE4664451FB101FD113B8A4A6B7323CFF1D66D620408652349C4E7384D9C844E9CA0D1CA21D7716A9139A70FDB49E34C050DE50393AEC507C1779E2495B6D0FCA01D2B5A5AEB7690E34F208A64FD3A849D032DF1783B30590D69090ACCD096CE882DE97397670257ADCD377CF645529BEDB9EE25DD61E2DC78F7E7E0A05E817E0A8B1752DEC441EA59C6D3CBF8C7E7CCF28001FDCACB3CC4C4D0CDD054BCA1682500139E9785060C77724DE01C23D0BA5983D64F7964E85BA43F1D92BAE55F8CFF0CE1AC7D833F11440B17C6C566C51D119EAD4FC3414727855E94A399CBD3912B653ED7244C63EBBF41C577FF10B08BAA66BD122AF8872AC25110598192F6E2DB2984F60B634F81D157D295F145D278B1C97B7635417BD2BD9B120267D2285D53D52F67B894DAB6B3FB93E5BE176019580E0F204F413F929AB12222DBA95D0AE2201BC9E27ECC1D218F06B2A2BE180A864EB539E901DB0040C06BF0719BFDD33226346609A8E2FF115F2F3615EEBE2F04646F4691C2B180739B7179D1A90ED902D8EEFC4FEC44709CAFDD39CAE4BD72EFF5DB226784A7EBAE40FAFE7AC08C0D53DAAC6972B676B45AA7BAB284AD45B6E52078C6224BDFB66282ACD59001D1CFAF89F9C9E70DEE791F752586026FF9319CAA199CD0FCF52E9018B77BED3BC1FD15CAEB3B6B9630E379AAC95026A989E109C6B13910766844ACAEAB4B91335C53EEA328F0735568EC31D148E032DF06884F7171861B3F5B7DA26DF720EB06C9A7C1BD88262E41C14D59B547C8AAE5F7194DE38F7897F097F8F4F35FB5525F1AD56F3ADC7064B65188B8D4A40D29CEEAFCC51E162A1D32A3A34A34EC2507FEC411542BE8B0B119E2F2D192D3322398B4D5906E8ACDB03BBE3FD9720170A4B32B84107DB61C14A25A6F96D062EA2811839B224328B04211DC416FADB8BBB535D14C64B428DB1AD5E1644405DA50ACACCA9A98712D66E179A7C09351F307C2B38E0188B8BC6F4D0B3DCD59EFD9DA1D659BD82A2D8557E7B6C7A688373EE756492AEFE93DD49BFC96F8B6A42AB987D06CCC91B8A1EA75DA3DE1BAFDB8D24512B270EB7CEA7789970F25DDCEB9D9D3B7979ECB0A4830FA0B99E71B704D4A8EB59B0E59726C4EA453258675EB55FB88EF4FB4B4778C3B33A1F4C25D7634803BE69A45885E0B5941E514F0CD8ACAEC0C300A81F10B30CE835829E38FC64B365AC9AEE9068C68D7A3C097E8AC1B898F52FE9F7F62C527AD4EF9C494E5C3193022D3C998582BBCAD5E1FFCC8265015AC10F93AD42DDEED364D184EB2998F658B2DF7EF8DF80E6EDF4242D1251AC005FA082DF33EC077E8B30BACDDF5E5CB5441DC185AC36DB4D58ABE2AA6616199D5D3E3F7915C5BF1BE84885106E27FD2C073278AFF73CFD4CE5D176F908B71BB394127C5C1B776D21D98879759751AE74D776660DBE2AC27241FB429A8E2465014D852E32FB4D111CCF4429AA8FBB87A3F36866C0C8372CE7A205094B749DC7272AF58070BB73CC0C1C09FEAFDB778EAC316310357A82CA9637A1E95D4C0AD496B4D40B881445396ED94208B55694CF43409082214D31F745A1B17DACEC443DE922C0A210E8C5DE4561C4E263A7EECF78B480223B80D38F8CCF9908717B96128B086A804D5E60A5E2E9E46682A97221FCB1E5BC6800AC4A5BE69E7F1DE5E6F76F8FC1F706B3B885856612551F69061E55F9C68DBCB5EF0C45198295BB784ABD2CA2195DE90561C2F02A8D06545EE7B272447FB299081477885865FAEA78A92E09A9F1418FB424475A78E5E1F62917A38E214C42B4946D0F80872E1C49D0F2B9C8118320CE3840DBAC80217061CA2DD32B69FC4F2E0364A318B025D56BBE7DE57FFAD32A909850130A628387E142792DA51295EE0077F140C5312DC01D968459855543C3FE22E49CEC8EA527C8A0CD87E0E2B6E8778CE1744A734D09E6438CEA033039596AAA57DF642DBCABC7E710740EA8449CF246ADE11708F30A1B1AE46454A0971FD894E218237C2600B8091F76DE5317689CC9CA80B24C40FD311DF9D808AD1A908E39C4A669444C882281C3B374C5931EF2E3574CFED89281B783D5B3A796773CA520DD277F10E14E6F82AE0C220FE3D32A26D1F2FC1079399C1B5E2EE4D2E4AB371586838176841CE74E59CD5868140F283ADFAEBBC594F82C3E4088523D4307F932B75C9141620CE9EFCB316E2FE5DB8F71426B8925D7BD0E364A3A4158DE17DCB0BB8F12F8F179ABA0768BC069BE3E4EDD9DA370276E07E9A6BFA560E351F9C1D8DE8B5785799816EEDD9E7CD471518BA06C401817CC7E25F61C3E156C78F27FD9532140C77C90E3916155471B2F554C6C103DEFE090EDDAFC31845542B1030CFAAA0F54AAA7E0BBAB6B1FF96BC2E4629B50B89349D8590D1F8C284888B029FB0ECF1B572F8A108FF1704F8B73E664FF1560826010C0B44645CA8BB2013F0E0245090ADF689994226E0FD4B9258897351A38DD69F1FE74B61D3D025856EEC8C1E2D8061DA08D68CAD6EEE979D600CEE32B97E2D2065FF15D524BE4AEF63D809E121C8BA9E90EE18BCAB60524B82E29AB0F8808D4A0D8E2432ED8824A865FC70AAEEAC189B4B9619F031704F0F1050F3E6A1629AE8762D2202BFDB568583B6F99BBDA47B2A0B382FFBC711D9E19439564268597F2775FBB83D306ED1A087828598E230F6E85D55B55E5E959E4A1D0A6F27B4472B96A1E22FFA8F20F69F3A10F1B6678D881DF562A2C7CFD76B059A7207824ADFB0DAA4959BA776C58439DEFA2FED246CA64B16A195170FD15A174B277581A5C660883F85FAE11442378048D8CE6F41D7BF3AF59E393BEEC13118A86F8AF4FC38BE3516E63E470B38301360059F6A9D1788A6B0C1E2EFB4EA9306FF9F8D0BAA49864612390FA8CF4FAFCC0ABB6C28599CF26B16C084A55A04BAFF25DF9EB56EE38BF5CB47372D5880FEFEF11FAD84EFF4DE0D97728186FB0D1FA0D974AB6136F9DC3551DC75FB9A009DDC6209C468F550CE46016D2F44BEB2DFF17B1F1527219AA85EE34CA33F0EF6122622C6AAE0BEFCD9E9D545DC2EB7BAD0D8F948B87474C5565A2AD1941F8EDA7834318064831074A2943A3556E62265C61E03CEE9F620C89F9B22A22148014DE81CC0F9ABEFB728EB0DCC83D9C8501B8F348A827F29903297D148870892B27F9D2F9AB04E842D392E9AE529F4CDA3C58DC80C10BAB7BFDC79C84BFE8A8B6F4375910B367F8956CA96D51C3A1956E4B195F609A27E029E0FCC7382D648933BF8CF9AA93C7209D7CAA665CBCF10A989AA53FF444E579829CDE0528EC058D3B38496550EEA0C3082BC1BAA80D9DE4D6C1E49C78D5E82455A026A014A90E071C4F4A61C3656E19B40B07822C6378A7D880E482006584D06A1C02B9CA95D16E6637380E6AE2C37ADF31D02F0EC418D9DD05BD143FE3DC7F48B5F2EEDB1B989DC1A0533DAEF90CA420BD31E5334CB310DA56F922BCF0760E07CAFC7225826DF9AEAEABD19D33D3BBF78B9A599FB602BB78933C88A33AA78CCB088FF2BBBAC44C86ECADE7B0EA30FFB4BB6141619854DCA6B504A04611D7FBC47C362BCD2B2EE21DFA9E3976E2F94A4CFAEB38E422E4E6B4E4D31333BAD004CAF4E99DA5F27EC115E793E6843DFAD0867DD68CF8797132D3CE76FB271440ACC27F1D2331A88AFFBCF2B27A8A90F3D5D9E0114F4EC00352F4A197364E811A425CA2F8D7BDDAD1C5448B044A491E7F66591FF47BA7589C75CF12B4DE645EE24F17691EE2ACA6CCD0C7DC8C340B4DD3F40BAA2C5758DAF20AE2EB095851755CC465FE92A31A71890A173C59A29C9AD47CDF4E9A34524AC009BB13E3FCC45031AB609983CE8F333E3383828D5DAC68E930CEA4ED374304FAEDE19F0E35FAE90D5E2D3C63FF196D4315E571F9550C55629C99CB4B8D0C98D021E95728515FD97E4E3B05C23C136DA7C7E8776549AA7FB84778592E7B054ACF8939B43C7D345C662AA8D91520C94C69A6B973973C39DDC804848EDC7A881C4CF118B3AF3CC0771DD92E322BC9978CBA960E264C9B25473CF2306AF8B6366E57FCCC216BAD1DBF1D432D1377CFC5F4FF7B0D7EE06EA5D71F0624140325107D960D65A030EF0CEE8043B4BAD2B90B669B3549A8302164AFEB060BB984146E709FBB5A5F2EBAD0EBAF8C41D6F7AD363DE2219B2FEBABBC31D1838652AB23919BC00843E7B0C4DDB677F26C11EDD164FD24D48FEB29CEC4F45186BA21DD9DCEAEBC23F2F6A90E3D5F178B79C61E99B44A59F4EBF2A66B39EDD156C7CFE228420AFA371E6EE08AD2FE91A822243C95A7AD9FE9F03891D705BE9BF194040C7C5D2876853A555E34F13CC6F4108517217183112C7A971B7C46BDBF9C2E6EA029E5B7E05B8888160C9ACD55578C566C612E4743D622A98B5BF38C0C77B9A93C2B89E54E1FF9BE6EAAB9A312B48019400F8AF19DC4603B9BF77BCEA9E73259C32214E04DB585720613C38D212EEE6445FCD9822492CC680BF82843D1E0B7824C969A6234848448645A257B77B1989FB31327837E691600E74D6F43B85814403C04541690D883DD412083462D707C0313A51E2CB44899ACA9BF8B0B93F8D9C33D8B1993426B6F814FBAC71A3CC4FE134283FC867D24BAA1FAC1E73697FDB7432712180D12FABD483485F6F6B86CF2EEF41B118470B0AD64F7CF05BBADD2C86F5DB99FC891E91AD9535D783E6BE5A1E9AB1FB64AFB270F84967472D37BAD1142013EB3522DB4E89A1B97D30D581EE874FE323E3FD8544461687D3277A7C9B64D41E0327223B77DDF6329737B4F082FB7671A823FC2FF4B55547C7587411C63D5025836A257B13E56E76FAE7B9C758716815C33D5E4412D5D47D2C2EF3D22CA9AC5D6FEA53045BCAA5687722596011BBE4B7111940F0143BE7D3B3128EC3EC36DB73D62CFA2AB438BE47FDF03A628DD5D8EB37FDC888F8B8B5B61C3FDD38E38A3EA1EEE39AF002919D2C1BC8A6B137716BF64974D19802D901CC617817182F2F3FE01E1BA4B18EDCEA9D6840666ACCBDF407269DED7D44852BF4A435C537B4F2DEE76157AAEF235B8A8F8EB81795C7926623C6B6769F3208F43C393E4EBF264F889246DFF06637EFF6E75D86C09944173FB61012253F8941611C81934E7C69C786C24059EC485CF458D69B34DAA8AE6D72F018FDBF1C64B628F21AC7C7DBE82314CE76D2A4EA38DF1A9ED0A7333ACD62EBE242E252305A334098588642E3ADD31D959C90B67F62CCE4F6AF0510DFCF6983657F1D8E0409B76F0D719315D25DD58D77CA0ED65D63DB83F60396035B80DEB9D2D512A7DACF813043E20774B5D2CEEC8BA7401BB6BD92816E19AB07EE0AB47DD7E26A0D1FC775FBC62DB8BBB23F023E454983BDFEE3D8A21C6ABF1EC3CFC2E967376F0820FCDFE9C4BDE5757A05E9D433E50096D150EDE01ADBE5AB17182B2542D7E721ED198846490A4FC1A15CBFABAEF0591FDC1093CA67DE81A39D0D09F5A756B1554EFD6C7A068EC4F744E80EAAE72E95A5C3505B6C2782C7D37EB440C72E592E590258D67B17330D9EED54D5839304643A09B5B821E1CD5AE5A1AC27E589B22213362F087D643795F9F6917B0CEBEF08DE6CABFF01F138484370F7BA1FF9187DA9137C88609CDB02D27A2843B03A7C0FC68CFB8F277630330B5CAD43B158BE9F4605F9370D2F421163E9F32FD744085D251F4CC9C416FAADF9EBD21BA348F4398DD156BDFAE4B14E16112B7507C7B01F8FBD59898ACD6D72B9DBFEBC40320F9E5BBBC456947A26F19D4063E25CA2E688288C8D5BC571EC107DFC673C616E8B788A2C394BF3A62E12C6FDA0536E5A3AC0400CE29CE1C3709AA6ACAA99CB3A6B05E68C52BD9A8D142179506A3326AA2B21EA745B9F4BB2DAF15E94E3CCA2EE2B962906FF588210782B277E23F8F2762FC234BA6FB1E6F490B008F50424C9D42B240FFB59D20C6E82A4FD479D017852EA035BD4D99966212FD4D555A21906FC1040800B0F7EAB042ED4D47E70BA76001138284C7ABDF787F0976BF609A46A95041762EF18B226151602AB7AF1265C7B54906CC632703C1DE45A22EA16E1303F92ED9CFCF4A1A35F77478A00DED19C3D9BE700038E15B2FA6F355E3823C0105DB1D1A63315BCCC0FC119E3DB905B82CC4A07A839FD2A1D2BAFF47D56B5913CBFF97857E6448C54764D9D18D975DEDE499DF18AD6ACC3F446821090162760A773A9CDA12CCB12DA464E7EC97828B472335C2AE5C764E0D613EF362BFCABE565A7970ECFD5B0AF1B1D84654DD5E90ABB12E41B357B065D1BA855C042928899A8AAF2C8CC703702052249A4FB3B4EE2E32198191EA0AEA1E9F2792E5A393226B59240358AE8785A309B07A7A9EC56F102577557F7E9960699BD1C541E4701E74C175FC47514E6933086B4446C53A3B6CE08FD7C55FCFB88E26953AB7DD356F17A959C396F8650DBAEE2E20C84A9772EE1E81325AD0CAA2D3AC14CD3635A0641A2E375AC69A67AD709F80026729E4D093C8D3110E19C8D136B9A00E821B4A1601F3618D98429CF2D2903D10949A6A47C9161F065051E71BB6297BE5849C946EF4CB58DB55DDFFE19FBF5A6117E1E2469F90D8182C1BFC459FB264B832BD9CD50E72C1867A362427CE55E77FE58313FC21361EA45D7EC77CE92FF7F7AD33AC2788199D680498771BB6F34770974BCCEE5519D58FD7DABEF5A0817A7762A0FDB559C0AD7EFD840D29562CB52A37E674052D4C735EEF45E969264EF25DC1D9825B7FD392C339DCB90E49B945EDE7929B4F69A47804F65D5C00549945CED96E793A8094348B687184A601E3CDDC6AB386A5E7D9E170FF2EDC3D8490D551EF2323AB4035AB33A87B48DE0E5573365B570DC2E8BCE6F46D37C17A952687EC596CA56564FD6601D5FA7F577BB8590B415CB85098F53155F2207C67A00007DFEB0F485B85334C965F003A9790D8A2A3C37997F285E2C3025C88DF815D80AE3981A6EADE870C409C5C5936F95CA82FBA9F6A429E5E4A053D5960B675EE9643CBA624E187CC0B441DEF9D82A787AE6158F2159995DE98DD81B229C076C1E128B4A504AF21D0E19BBFC1FC2A46125E430A27E150E663B7F7BD3D8B85B382C67C95097524B635B1D5C15081A1CC8891A1292EDDBA28F8B8233A8F76D8339A405F5FCEB248E7EEA42DEC647A93A10AF1AAB66D8B3863A8302EF6959A976F65E57A33D6BDB8621370003E4E8674179729EF8052193BC0C6648339AE1CBEA0D470F04700B9CBADF09AE1FCEF8C766995B894839DA0DA6993C38B6E8D910355056126C59CD26B471F441E19044523CB16B583EA05AF65938AC31421CFEADE9757BD093E1E882C1EAE26FBEF75D494C717526A53C72D3C37E7A9FAFFA07674BAA1C013A45FA467893C2E35F79CED0BABAD63FDD186BCB5342A55E74110A128864752785E0F1CD90BA524A3F49A6196591542D751572BE3C2115F6A5E7C32B50C5D7905913635CA39C478887CF9CD9ACC2BE50A6358ECD9C6AB867D3ACD7459EC44295D1AD6217CC32EFF3D9A8297702C1BBA723CBFA1BF32D4BF1C6C6491CE91E12C39247B341CE4A4A58F5E7E7F3EF752BD349E681F1287CC81FA7C5C2EF754EF62027429EABEAF346369BF42EC338ADD836059990EBEBD2DAD02A37BDC18FAD2CEB5957794B02184090DF1C2BE09BABABBCAB0A0C54DB8E2B4B81348C69376921341F937BB4C263FBC194A5771E22B6C5CD52F87DF8705C70C8FB210A15C739", TestName = "TupleHash 256 MCT")]
        public void ShouldMonteCarloTestTupleHashForSampleSuppliedCase(int digestSize, string message, string digest)
        {
            var subject = new TupleHash_MCT(new Crypto.TupleHash.TupleHash());
            var messageBitStringTuple = new List<BitString>(new BitString[] { new BitString(message) });
            var digestBitString = new BitString(digest);
            var hashFunction = new HashFunction
            {
                Capacity = digestSize * 2,
                DigestLength = digestSize,
                XOF = false
            };

            var domain = new MathDomain();
            domain.AddSegment(new RangeDomainSegment(null, 16, 65536, 8));
            var result = subject.MCTHash(hashFunction, messageBitStringTuple, domain, true, true);

            Assert.That(result, Is.Not.Null, "null check");
            Assert.That(result.Success, Is.True, result.ErrorMessage);

            var resultDigest = result.Response[result.Response.Count - 1].Digest;
            //            Console.WriteLine($"Should be: {digestBitString.ToHex()}");
            //            Console.WriteLine($"Is       : {resultDigest.ToHex()}");
            Assert.That(resultDigest.BitLength, Is.EqualTo(digestBitString.BitLength));
            Assert.That(resultDigest.ToHex(), Is.EqualTo(digestBitString.ToHex()));
        }
    }
}
